# topMSO 客戶離退預測專案

本專案包含針對原始有線電視用戶資料的預處理、視覺化分析，以及機器學習模型建置，目的是探索並預測用戶離退（Churn）行為，支援企業精準營運決策。

---

## 📂 程式說明

### 1. `topMSO_Dataset.ipynb`

- **功能**：針對原始資料檔進行預處理，清除離散度過大、非關注服務、甚至不合理資料。
- **內容**：關聯多份原始資料，建構組合後的清洗資料集，以供後續分析與模型使用。
- **輸出檔案**：

| 檔案名稱              | 說明                                                                 |
|-----------------------|----------------------------------------------------------------------|
| `cleaned_dataset2.csv`     | 去識別化後的用戶服務資料集。因檔案過大，提供 [Google Drive 下載連結](https://drive.google.com/file/d/1YK3mAFEyT3nr9Qba7fbNOBz4u88KRyI1/view?usp=sharing) |
| `cleaned_ds_doService.csv` | 去識別化後的派工單資料集。因檔案過大，提供 [Google Drive 下載連結](https://drive.google.com/file/d/1YL82PAH9FkJwbzUo_LB3aAGyX5os70nq/view?usp=sharing) |
| `serviceDay_diff.csv`      | 以最後一次派工單為基準，統計 30 天、60 天、90 天內及以上的派工次數之資料集。 |
| `ds_doService_combo.csv`   | 將派工單 + 用戶服務 + 派工次數整合的合併資料集。                           |

---

### 2. `topMSO_visualization.ipynb`

- **功能**：以視覺化方式理解資料特性，針對可能與拆機/離退行為相關的因素進行探索。
- **重點分析項目**：
  - 派工次數與等待時間分布
  - 資料間的邏輯與統計相關性驗證

---

## 🧠 機器學習模組

### 📊 資料集說明

| 檔案名稱               | 說明 |
|------------------------|------|
| `ds_numService.csv`    | 由 `topMSO_LogisticRegression.ipynb` 經過資料過濾與欄位數值化後產生，並應用於後續機器學習訓練 |
| `train_data_column.csv` | 整合訓練資料與欄位名稱，取代原本 `ai_train_data.csv` 及 `欄位名稱.txt` |
| 🔁 `SMOTE` 擴充技術   | 由於正負樣本分布不均，訓練資料經過 SMOTE 處理以平衡樣本比例 |

### 🧪 使用模型與程式

| 程式檔案名稱                    | 說明                         |
|----------------------------------|------------------------------|
| `topMSO_LogisticRegression.ipynb` | 邏輯回歸模型建置與評估       |
| `topMSO_DecisionTree.ipynb`      | 決策樹分類模型訓練與視覺化   |
| `topMSO_KNN.ipynb`               | K-最近鄰（KNN）分類模型分析，**本方法於各模型中表現最佳，accuracy最高，因此另儲存預訓練模型檔 `knn_model.pkl`** |
| `topMSO_SVM.ipynb`               | 支援向量機（SVM）模型建構   |
| `topMSO_predict.ipynb`           | 載入 `knn_model.pkl` 模型，針對近期資料集 `ds_test_大屯2025Q1.csv` 進行離退預測並輸出名單 |

---

## 📂 平行專案測試資料集

以下資料並未應用於本專案程式碼中，主要由其他平行專案用於測試與驗證模型行為：

| 檔案名稱                    | 說明 |
|-----------------------------|------|
| `ai_pred_data_20250331.csv` | 2025 年用戶預測資料，供模型推論用 |
| `20250331-離退清單.xls`     | 2025 年 3 月實際離退用戶清單，用於驗證預測結果準確性 |
| `train_data_column.csv`     | 同時應用於該專案訓練模型之欄位與資料合併格式 |

---

## 🧭 模型強化未來規劃：加入多元資料來源

目前模型主要建立於派工單資料，樣本結構存在偏差風險。後續將納入以下關鍵變量，以提升模型準確度與解釋力：

| 類別           | 變數描述                                        | 預期效益 |
|----------------|-------------------------------------------------|----------|
| 📞 客服來電紀錄 | - 來電頻率（次/月）<br>- 客服互動時間長度       | 補足服務互動指標、辨識不滿情境 |
| 💬 客服語意分析 | - 語意正負分數（經NLP情緒分析判斷）              | 揭示潛在情緒不穩客戶行為特徵 |
| 💳 繳款行為     | - 平均繳款延遲日數<br>- 繳款方式類型（信用卡、自動轉帳等） | 判別流動性壓力與付款習慣差異 |
| 🌐 網路品質     | - 頻寬過低次數<br>- 延遲/丟包異常出現頻率         | 客觀網路體驗品質，有助推論黏著度 |

---

## 📦 原始資料說明

### 1. `用戶服務資料2.zip`
- **內容**：個資去識別化後的客戶基本服務資料
- **格式**：CSV 檔，欄位間以 `^` 符號分隔

### 2. `工單.zip`
- **內容**：2022~2024 年的用戶派工單資料
- **格式**：CSV 檔，欄位間以 `^` 符號分隔

---

## 🎯 專案目標

- 建構拆機/離退預測模型
- 探索影響客戶忠誠度的因素
- 提供數據支撐的營運優化建議

---

## 📬 聯絡人

研究負責人：kevinlo937@gmail.com  
（如需資料或技術討論，請透過專案頁留言）

